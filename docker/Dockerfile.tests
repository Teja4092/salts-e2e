FROM mcr.microsoft.com/playwright:v1.48.0-noble

WORKDIR /app

# Set environment variables
ENV NODE_ENV=test
ENV CI=true

# Copy package files
COPY package*.json ./

# Install dependencies
RUN npm ci

# Copy test configuration and files
COPY playwright.config.ts ./
COPY tsconfig.json ./
COPY tests/ ./tests/

# Create directories for results
RUN mkdir -p test-results playwright-report

# Install Playwright browsers (should already be in base image)
RUN npx playwright install --with-deps

# Default command
CMD ["npm", "test"]